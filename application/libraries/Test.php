<?php

require __DIR__ . '/Collection.php';


$json = '{"00:00":{"2017030116_i_505297590_2017030116_o_603227950":"41.46341200240398","2017030116_i_63461810_2017030116_o_603227810":"40.918135060673265"},"00:30":{"2017030116_i_505297590_2017030116_o_603227950":"53.25596670670943","2017030116_i_63461810_2017030116_o_603227810":"58.16254658064819"},"01:00":{"2017030116_i_505297590_2017030116_o_603227950":"52.22879519705045","2017030116_i_63461810_2017030116_o_603227810":"46.529220011327176"},"01:30":{"2017030116_i_505297590_2017030116_o_603227950":"20.749993006388348","2017030116_i_63461810_2017030116_o_603227810":"38.666666666666664"},"02:00":{"2017030116_i_505297590_2017030116_o_603227950":"54.445454545454545","2017030116_i_63461810_2017030116_o_603227810":"58.30101959072814"},"02:30":{"2017030116_i_505297590_2017030116_o_603227950":"29.795454545454547","2017030116_i_63461810_2017030116_o_603227810":"38.13768115942029"},"03:00":{"2017030116_i_505297590_2017030116_o_603227950":"0","2017030116_i_63461810_2017030116_o_603227810":"59.2093023255814"},"03:30":{"2017030116_i_505297590_2017030116_o_603227950":"11.875","2017030116_i_63461810_2017030116_o_603227810":"31.852941176470587"},"04:00":{"2017030116_i_505297590_2017030116_o_603227950":"20.80952380952381","2017030116_i_63461810_2017030116_o_603227810":"32.81818181818182"},"04:30":{"2017030116_i_505297590_2017030116_o_603227950":"8.344370860927153","2017030116_i_63461810_2017030116_o_603227810":"42.88725359299604"},"05:00":{"2017030116_i_505297590_2017030116_o_603227950":"2.2897016935259384","2017030116_i_63461810_2017030116_o_603227810":"39.84375"},"05:30":{"2017030116_i_505297590_2017030116_o_603227950":"32.15974002143445","2017030116_i_63461810_2017030116_o_603227810":"45.97866871910637","2017030116_i_63461831_2017030116_o_63349551":"66.5"},"06:00":{"2017030116_i_505297590_2017030116_o_603227950":"58.53507110351073","2017030116_i_63461810_2017030116_o_603227810":"32.17272872491316","2017030116_i_63461810_2017030116_o_63349551":"47.5","2017030116_i_63461831_2017030116_o_63349551":"171"},"06:30":{"2017030116_i_505297590_2017030116_o_603227950":"63.65","2017030116_i_63461810_2017030116_o_603227810":"50.659339401748156","2017030116_i_63461810_2017030116_o_63349551":"80.59166666666667","2017030116_i_63461831_2017030116_o_603227810":"66.5","2017030116_i_63461831_2017030116_o_63349551":"159.26920729417068"},"07:00":{"2017030116_i_505297590_2017030116_o_603227950":"63.72026839385162","2017030116_i_63461810_2017030116_o_603227810":"50.377544169523276","2017030116_i_63461810_2017030116_o_63349551":"28.5","2017030116_i_63461831_2017030116_o_603227810":"95","2017030116_i_63461831_2017030116_o_603227950":"76","2017030116_i_63461831_2017030116_o_63349551":"91.83333333333333"},"07:30":{"2017030116_i_505297590_2017030116_o_603227950":"75.86966185837649","2017030116_i_63461810_2017030116_o_603227810":"58.547543379426735","2017030116_i_63461810_2017030116_o_63349551":"47.5","2017030116_i_63461831_2017030116_o_603227810":"69.54","2017030116_i_63461831_2017030116_o_63349551":"114.55882352941177"},"08:00":{"2017030116_i_505297590_2017030116_o_603227950":"81.29494892467152","2017030116_i_505297590_2017030116_o_63349551":"121.38888888888889","2017030116_i_63461810_2017030116_o_603227810":"100.96555584784053","2017030116_i_63461810_2017030116_o_63349551":"66.5","2017030116_i_63461831_2017030116_o_603227810":"191.97916666666666","2017030116_i_63461831_2017030116_o_603227950":"148.83333333333334","2017030116_i_63461831_2017030116_o_63349551":"104.5"},"08:30":{"2017030116_i_505297590_2017030116_o_603227950":"87.77499951171875","2017030116_i_505297590_2017030116_o_63349551":"127.57142857142857","2017030116_i_63349550_2017030116_o_603227810":"256.5","2017030116_i_63349550_2017030116_o_603227950":"237.5","2017030116_i_63461810_2017030116_o_603227810":"69.45287586525443","2017030116_i_63461810_2017030116_o_63349551":"71.07407407407408","2017030116_i_63461831_2017030116_o_603227810":"149.93478260869566","2017030116_i_63461831_2017030116_o_603227950":"180.5","2017030116_i_63461831_2017030116_o_63349551":"180.5"},"09:00":{"2017030116_i_505297590_2017030116_o_603227950":"87.50472483067071","2017030116_i_505297590_2017030116_o_63349551":"61.07142857142857","2017030116_i_63461810_2017030116_o_603227810":"73.23417541890204","2017030116_i_63461831_2017030116_o_603227810":"133","2017030116_i_63461831_2017030116_o_603227950":"135.71428571428572"},"09:30":{"2017030116_i_505297590_2017030116_o_603227950":"88.28319589793682","2017030116_i_505297590_2017030116_o_63349551":"150.8125","2017030116_i_63349550_2017030116_o_603227950":"76","2017030116_i_63461810_2017030116_o_603227810":"79.98673568037523","2017030116_i_63461810_2017030116_o_63349551":"57","2017030116_i_63461831_2017030116_o_603227950":"142.5"},"10:00":{"2017030116_i_505297590_2017030116_o_603227950":"100.08395971050699","2017030116_i_505297590_2017030116_o_63349551":"98.01219512195122","2017030116_i_63461810_2017030116_o_603227810":"68.10107972191983"},"10:30":{"2017030116_i_505297590_2017030116_o_603227950":"95.29680365296804","2017030116_i_505297590_2017030116_o_63349551":"130.625","2017030116_i_63349550_2017030116_o_603227950":"104.5","2017030116_i_63461810_2017030116_o_603227810":"57.327892150112135","2017030116_i_63461831_2017030116_o_603227810":"127.75862068965517","2017030116_i_63461831_2017030116_o_603227950":"133","2017030116_i_63461831_2017030116_o_63349551":"247"},"11:00":{"2017030116_i_505297590_2017030116_o_603227950":"98.21777761427023","2017030116_i_505297590_2017030116_o_63349551":"53.64705882352941","2017030116_i_63349550_2017030116_o_603227810":"161.5","2017030116_i_63461810_2017030116_o_603227810":"68.95134878416319","2017030116_i_63461831_2017030116_o_603227810":"129.02727272727273","2017030116_i_63461831_2017030116_o_63349551":"85.5"},"11:30":{"2017030116_i_505297590_2017030116_o_603227950":"107.1604418192368","2017030116_i_505297590_2017030116_o_63349551":"99.75","2017030116_i_63461810_2017030116_o_603227810":"51.709594707296354","2017030116_i_63461810_2017030116_o_63349551":"57","2017030116_i_63461831_2017030116_o_603227810":"76"},"12:00":{"2017030116_i_505297590_2017030116_o_603227950":"72.37125405268883","2017030116_i_505297590_2017030116_o_63349551":"9.5","2017030116_i_63461810_2017030116_o_603227810":"53.55304595582997","2017030116_i_63461810_2017030116_o_63349551":"57","2017030116_i_63461831_2017030116_o_603227810":"150.56060606060606","2017030116_i_63461831_2017030116_o_603227950":"71.25"},"12:30":{"2017030116_i_505297590_2017030116_o_603227950":"70.4500512619165","2017030116_i_505297590_2017030116_o_63349551":"0","2017030116_i_63349550_2017030116_o_603227950":"199.5","2017030116_i_63461810_2017030116_o_603227810":"45.145913905148056","2017030116_i_63461810_2017030116_o_63349551":"47.5","2017030116_i_63461831_2017030116_o_603227810":"195.49996948242188"},"13:00":{"2017030116_i_505297590_2017030116_o_603227950":"96.70321195202199","2017030116_i_505297590_2017030116_o_63349551":"0","2017030116_i_63461810_2017030116_o_603227810":"46.38131313131313","2017030116_i_63461810_2017030116_o_63349551":"47.5","2017030116_i_63461831_2017030116_o_603227810":"82.78571428571429","2017030116_i_63461831_2017030116_o_603227950":"95"},"13:30":{"2017030116_i_505297590_2017030116_o_603227950":"80.39225125808572","2017030116_i_63461810_2017030116_o_603227810":"57.29684786904942","2017030116_i_63461831_2017030116_o_603227810":"101.73636363636363","2017030116_i_63461831_2017030116_o_603227950":"85.5","2017030116_i_63461831_2017030116_o_63349551":"85.5"},"14:00":{"2017030116_i_505297590_2017030116_o_603227950":"76.38220210727171","2017030116_i_505297590_2017030116_o_63349551":"0","2017030116_i_63461810_2017030116_o_603227810":"43.98699622216163","2017030116_i_63461810_2017030116_o_63349551":"66.5","2017030116_i_63461831_2017030116_o_603227810":"66.5","2017030116_i_63461831_2017030116_o_63349551":"95"},"14:30":{"2017030116_i_505297590_2017030116_o_603227950":"80.61111187678512","2017030116_i_505297590_2017030116_o_63349551":"171","2017030116_i_63461810_2017030116_o_603227810":"75.34441247065674","2017030116_i_63461831_2017030116_o_603227810":"143.30851063829786"},"15:00":{"2017030116_i_505297590_2017030116_o_603227950":"83.35865721495256","2017030116_i_505297590_2017030116_o_63349551":"9.5","2017030116_i_505297590_2017030116_o_63461830":"171","2017030116_i_63349550_2017030116_o_603227950":"161.5","2017030116_i_63461810_2017030116_o_603227810":"61.44788565055904","2017030116_i_63461831_2017030116_o_603227810":"171","2017030116_i_63461831_2017030116_o_603227950":"123.5"},"15:30":{"2017030116_i_505297590_2017030116_o_603227950":"75.51112012993799","2017030116_i_505297590_2017030116_o_63349551":"13.232142857142858","2017030116_i_63461810_2017030116_o_603227810":"77.73214126119808","2017030116_i_63461810_2017030116_o_63349551":"57","2017030116_i_63461831_2017030116_o_603227810":"156.26530612244898"},"16:00":{"2017030116_i_505297590_2017030116_o_603227950":"79.07447427243602","2017030116_i_63461810_2017030116_o_603227810":"45.98315832899024","2017030116_i_63461831_2017030116_o_603227810":"143.6875","2017030116_i_63461831_2017030116_o_603227950":"133"},"16:30":{"2017030116_i_505297590_2017030116_o_603227950":"85.69415957107391","2017030116_i_505297590_2017030116_o_63349551":"57.25675675675676","2017030116_i_63461810_2017030116_o_603227810":"60.34693318136232","2017030116_i_63461831_2017030116_o_603227810":"119.79268292682927","2017030116_i_63461831_2017030116_o_603227950":"171"},"17:00":{"2017030116_i_505297590_2017030116_o_603227950":"75.16585434400119","2017030116_i_505297590_2017030116_o_63349551":"180.5","2017030116_i_63461810_2017030116_o_603227810":"64.0919527294992","2017030116_i_63461810_2017030116_o_63349551":"38"},"17:30":{"2017030116_i_505297590_2017030116_o_603227950":"119.40998687744141","2017030116_i_505297590_2017030116_o_63461830":"38","2017030116_i_63461810_2017030116_o_603227810":"77.99250385718432","2017030116_i_63461831_2017030116_o_603227810":"135.06521739130434"},"18:00":{"2017030116_i_505297590_2017030116_o_603227950":"118.61748446271719","2017030116_i_505297590_2017030116_o_63349551":"61.244680851063826","2017030116_i_505297590_2017030116_o_63461830":"190","2017030116_i_63461810_2017030116_o_603227810":"49.6698074628722","2017030116_i_63461831_2017030116_o_603227810":"171","2017030116_i_63461831_2017030116_o_603227950":"161.5"},"18:30":{"2017030116_i_505297590_2017030116_o_603227950":"125.70045325207548","2017030116_i_505297590_2017030116_o_63349551":"19","2017030116_i_505297590_2017030116_o_63461830":"190","2017030116_i_63349550_2017030116_o_603227950":"237.5","2017030116_i_63461810_2017030116_o_603227810":"48.21159289816151","2017030116_i_63461810_2017030116_o_63349551":"57","2017030116_i_63461831_2017030116_o_603227810":"237.5","2017030116_i_63461831_2017030116_o_603227950":"57"},"19:00":{"2017030116_i_505297590_2017030116_o_603227950":"98.12911808050951","2017030116_i_505297590_2017030116_o_63349551":"9.5","2017030116_i_505297590_2017030116_o_63461830":"38","2017030116_i_63461810_2017030116_o_603227810":"66.27271864375966","2017030116_i_63461831_2017030116_o_603227810":"60.325","2017030116_i_63461831_2017030116_o_603227950":"166.8695652173913"},"19:30":{"2017030116_i_505297590_2017030116_o_603227950":"59.016626201553514","2017030116_i_63349550_2017030116_o_603227950":"95","2017030116_i_63461810_2017030116_o_603227810":"45.690201729106626","2017030116_i_63461831_2017030116_o_603227810":"57"},"20:00":{"2017030116_i_505297590_2017030116_o_603227950":"132.24999420805128","2017030116_i_505297590_2017030116_o_63349551":"0","2017030116_i_63461810_2017030116_o_603227810":"59.42418523849621","2017030116_i_63461831_2017030116_o_603227810":"19"},"20:30":{"2017030116_i_505297590_2017030116_o_603227950":"97.06284153005464","2017030116_i_63461810_2017030116_o_603227810":"47.33969347336713"},"21:00":{"2017030116_i_505297590_2017030116_o_603227950":"85.17603013078137","2017030116_i_505297590_2017030116_o_63349551":"180.5","2017030116_i_63461810_2017030116_o_603227810":"58.91373676385361","2017030116_i_63461831_2017030116_o_603227810":"38"},"21:30":{"2017030116_i_505297590_2017030116_o_603227950":"76.10883162621738","2017030116_i_505297590_2017030116_o_63349551":"199.5","2017030116_i_63461810_2017030116_o_603227810":"65.57925473189935","2017030116_i_63461810_2017030116_o_63349551":"47.5"},"22:00":{"2017030116_i_505297590_2017030116_o_603227950":"105.63261741545142","2017030116_i_505297590_2017030116_o_63349551":"199.5","2017030116_i_63461810_2017030116_o_603227810":"78.01753934224446","2017030116_i_63461831_2017030116_o_603227810":"62.18181818181818"},"22:30":{"2017030116_i_505297590_2017030116_o_603227950":"97.36574693373692","2017030116_i_63349550_2017030116_o_603227950":"228","2017030116_i_63461810_2017030116_o_603227810":"55.35351377544981"},"23:00":{"2017030116_i_505297590_2017030116_o_603227950":"99.42878459583629","2017030116_i_63461810_2017030116_o_603227810":"21.86273874021044","2017030116_i_63461831_2017030116_o_603227810":"47.5"},"23:30":{"2017030116_i_505297590_2017030116_o_603227950":"74.0702678936358","2017030116_i_63461810_2017030116_o_603227810":"26.19402985074627"}}';

$dataByHour = Collection::make(json_decode($json, true));

$maxFlowIds = $dataByHour->reduce(function ($carry, $item){
    return Collection::make($item)->keysOfMaxValue()->reduce(function ($ca, $it) {
        $ca->increment($it); return $ca;
    }, $carry);
}, Collection::make([]))->keysOfMaxValue()->all();

var_dump($maxFlowIds);